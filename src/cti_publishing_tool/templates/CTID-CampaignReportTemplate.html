<!DOCTYPE html>
<html>
    <head>
        <title>CTID - Campaign Report</title>
        <style>
            body {
                white-space: pre-wrap;
            }
            th {
                background: black;
                color: white;
                padding: 5px;
            }
            table, th, td {
                border: solid 1px black;
                border-collapse: collapse;
            }
            .report-header {
                text-align:left;
            }
            .report-header span {
                float:right;
            }
            .page-break {
                page-break-before: always;
                text-align:left;
            }
            .hash {
                word-wrap: break-word;
                word-break: break-all;
            }
        </style>
    </head>
    <body>
        <p class="report-header">
            <table>
                <thead>
                    <tr>
                        <th>Report Date</th>
                        <th>Sensitivity</th>
                        <th>Traffic Light Protocol</th>
                        <th>Criticality</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{{ report_date }}</td>
                        <td>{{ sensitivity }}</td>
                        <td>{{ traffic_light_protocol }}</td>
                        <td>{{ criticality }}</td>
                    </tr>
                </tbody>
            </table>
        </p>
        <hr/>
        <h1>{{ report_title }}</h1>
        <h2>Executive Summary</h2>
        <p>{{ executive_summary }}</p>
        <h2>Key Points</h2>
        <p>{{ key_points }}</p>
        <h2>Assessment</h2>
        <p>{{ assessment }}</p>
        <h2>Key Intelligence Gaps</h2>
        <p>{{ intelligence_gaps }}</p>
        <h2>MITRE ATT&amp;CK Table (based on v12)</h2>
        <p>Table of the MITRE ATT&amp;CK tactics and techniques/sub-techniques from the campaign. The procedure column details a particular instance of how a technique/sub-technique has been used. The D3FEND column includes the corresponding MITRE D3FEND countermeasure technique, if available. If using the tool, the Tactics and Techniques can be automatically generated from an Attack Flow document using the plug-in.</p>
        <table>
            <thead>
                <tr>
                    <th>Attribution</th>
                    <th>Tactics</th>
                    <th>Techniques</th>
                    <th>Sub Technique</th>
                    <th>Procedure</th>
                    <th>D3FEND</th>
                    <th>Deployed Control</th>
                </tr>
            </thead>
            <tbody>
                {%- for attackTableRow in mitre_attack_table -%}
                <tr>
                    <td>{{ attackTableRow.attribution }}</td>
                    <td>{{ attackTableRow.tactic }}</td>
                    <td>{{ attackTableRow.technique }}</td>
                    <td>{{ attackTableRow.sub_technique }}</td>
                    <td>{{ attackTableRow.procedure }}</td>
                    <td>{{ attackTableRow.defend }}</td>
                    <td>{{ attackTableRow.control }}</td>
                </tr>
                {%- endfor -%}
            </tbody>
        </table>
        <h2>Timeline of Activity</h2>
        <table>
            <thead>
                <tr>
                    <th>Atthibution</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Location</th>
                    <th>Sector</th>
                    <th>Activity</th>
                </tr>
            </thead>
            <tbody>
                {%- for timelineRow in timeline -%}
                <tr>
                    <td>{{ timelineRow.attribution }}</td>
                    <td>{{ timelineRow.start_data }}</td>
                    <td>{{ timelineRow.end_data }}</td>
                    <td>{{ timelineRow.location }}</td>
                    <td>{{ timelineRow.sector }}</td>
                    <td>{{ timelineRow.activity }}</td>
                </tr>
                {%- endfor -%}
            </tbody>
        </table>
        <p class="page-break"></p>
        <h2>Indicators of Compromise (IOC)</h2>
        <p>This section consists of three IOC tables [Malware, Network, and System Artifacts] associated with the Campaign.</p>
        <h2>Malware</h2>
        <table>
            <thead>
                <tr>
                    <th>Attribution</th>
                    <th>Malicious Tool Name</th>
                    <th>Hash Type</th>
                    <th>File Hash</th>
                    <th>Associated Files Hash</th>
                    <th>Brief Description</th>
                    <th>Malware Analysis Report (Hyperlink, or N/A)</th>
                    <th>First Reported</th>
                    <th>Last Reported</th>
                </tr>
            </thead>
            <tbody>
                {%- for malwareRow in iocs.malware -%}
                <tr>
                    <td>{{ malwareRow.attribution }}</td>
                    <td>{{ malwareRow.ioc_malware_name }} </td>
                    <td>{{ malwareRow.ioc_malware_hash_type }} </td>
                    <td class="hash">{{ malwareRow.ioc_malware_hash }} </td>
                    <td class="hash">{{ malwareRow.ioc_associated_file_hash }} </td>
                    <td>{{ malwareRow.ioc_malware_description }}</td>
                    <td>{{ malwareRow.ioc_malware_description }}</td>
                    <td>{{ malwareRow.timestamp }}</td>
                    <td>{{ malwareRow.timestamp }}</td>
                </tr>
                {%- endfor -%}
            </tbody>
        </table>
        <h2>Network</h2>
        <p>This table should detail the network indicators associated with the campaign, e.g., domains and IP addresses. The &OpenCurlyDoubleQuote;Intrusion Phase&CloseCurlyDoubleQuote; column includes Initial Access, Command and Control, and Exfiltration. The first and last reported fields are intended to memorialize the longevity of a particular network artifact, providing additional insight into trends in malicious behavior.</p>
        <table>
            <thead>
                <tr>
                    <th>Attribution</th>
                    <th>Network Artifact</th>
                    <th>Details</th>
                    <th>Intrusion Phase</th>
                    <th>First Reported</th>
                    <th>Last Reported</th>
                </tr>
            </thead>
            <tbody>
                {%- for networkRow in iocs.network -%}
                <tr>
                    <td>{{ networkRow.attribution }}</td>
                    <td>{{ networkRow.artifact }}</td>
                    <td>{{ networkRow.details }}</td>
                    <td>{{ networkRow.network_intrusion_phase }}</td>
                    <td>{{ networkRow.first_observed }}</td>
                    <td>{{ networkRow.last_observed }}</td>
                </tr>
                {%- endfor -%}
            </tbody>
        </table>
        <h2>System Artifacts</h2>
        <p>This table should detail any unique artifacts associated with the campaign that could be observed on a host, e.g., processes, DLLs, registry keys. The first and last reported fields are intended to memorialize the longevity of a particular system artifact, providing additional insight into trends in malicious behavior.</p>
        <table>
            <thead>
                <tr>
                    <th>Attribution</th>
                    <th>Host Artifact</th>
                    <th>Type</th>
                    <th>Details</th>
                    <th>Tactic</th>
                    <th>First Reported</th>
                    <th>Last Reported</th>
                </tr>
            </thead>
            <tbody>
                {%- for sysArtifactRow in iocs.system_artifacts -%}
                <tr>
                    <td>{{ sysArtifactRow.attribution }}</td>
                    <td>{{ sysArtifactRow.artifact }}</td>
                    <td>{{ sysArtifactRow.type }}</td>
                    <td>{{ sysArtifactRow.system_details }}</td>
                    <td>{{ sysArtifactRow.tactic }}</td>
                    <td>{{ sysArtifactRow.first_observed }}</td>
                    <td>{{ sysArtifactRow.last_observed }}</td>
                </tr>
                {%- endfor -%}
            </tbody>
        </table>
        <h2>Common Vulnerabilities and Exposures (CVEs)</h2>
        <p>CVEs associated with the campaign. The date reported field is designed to capture the date when the CVE became public knowledge. To adequately fill out this table, it may require information from other internal teams.</p>
        <table>
            <thead>
                <tr>
                    <th>Attribution</th>
                    <th>CVE Number</th>
                    <th>CVSS Score</th>
                    <th>Patch Available (Y/N)</th>
                    <th>Other Remediation</th>
                    <th>Date Reported</th>
                    <th>Patch Applied  (Y/N/UNK/NA)</th>
                </tr>
            </thead>
            <tbody>
                {%- for CVE in iocs.cves -%}
                <tr>
                    <td>{{ CVE.attribution }}</td>
                    <td>{{ CVE.cve_number }}</td>
                    <td>{{ CVE.cve_cvss_score }}</td>
                    <td>{{ CVE.cve_patch_available }}</td>
                    <td>{{ CVE.cve_remediation }}</td>
                    <td>{{ CVE.date_of_report }}</td>
                    <td>{{ CVE.cve_patch_applied }}</td>
                </tr>
                {%- endfor -%}
            </tbody>
        </table>
        <h2>Signatures</h2>
        <p>This section should include detections (e.g., Yara signature) that correspond to the malware or malicious activity associated with the campaign.</p>
        <ol>
            {%- for sig in iocs.signatures -%}
            <li>{{ sig.attribution }}</li>
            <li>{{ sig.ioc_malware_name }}</li>
            <li>{{ sig.signature_description }}</li>
            {%- endfor -%}
        </ol>
        <h2>Attached Attack Flow and/or Navigator Heat Maps, if applicable</h2>
        <h2>Probability Matrix</h2>
        <p>We recommend that analysts properly express and explain uncertainties associated with major analytic judgments.</p>
        <table>
            <thead>
                <tr>
                    <th>Almost no chance</th>
                    <th>Very unlikely</th>
                    <th>Unlikely</th>
                    <th>Roughly Even Chance</th>
                    <th>Likely</th>
                    <th>Very likely</th>
                    <th>Almost certain(ly)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>01&#8211;05%</td>
                    <td>05&#8211;20%</td>
                    <td>20&#8211;45%</td>
                    <td>45&#8211;55%</td>
                    <td>55&#8211;80%</td>
                    <td>80&#8211;95%</td>
                    <td>95&#8211;99%</td>
                </tr>
            </tbody>
        </table>
        <h2>Intelligence Requirements</h2>
        <p>Brief citation of CTI requirements(s) addressed by this report.</p>
        <ul>
            {%- for requirement in intelligence_requirements -%}
            <li>{{ requirement.intelligence_requirement }}</li>
            {%- endfor -%}
        </ul>
        <h2>Feedback</h2>
        <p>Provide a point of contact (e.g., an email address) for customer feedback on the published CTI report, such as whether the report addressed the customers&quot; Intelligence Requirements, how the report could be more actionable, additional Intelligence Requirement questions to answer, etc. </p>
        <hr>
            <h3>Data Sources:</h3>
            <ul>
                {%- for citation in data_sources.report_citations -%}
                <li>{{ citation.description }}
                    {{ citation.hyperlink }}</li>
                {%- endfor -%} 
                {%- for telemetry in data_sources.internal_telemetry -%}
                <li>{{ telemetry.internal_telemetry }}</li>
                {%- endfor -%}
            </ul>
        <br>
        <h2>Metadata</h2>
        <p>The metadata info below is for automation purposes and provides discrete fields for tool extraction. If you are not using the tool, we recommend removing the info.</p>
            <h3>Threat Actor:</h3>
            <ul>
                {%- for threat_actor in metadata.threat_actors -%}
                <li>{{ threat_actor.threat_actor_name }}</li>
                <li>{{ threat_actor.threat_actor_aliases }}</li>
                {%- endfor -%}
            </ul>
            <h3>Victim Location:</h3>
            <ul>
                {%- for loc in metadata.victim_location -%}
                <li>{{ loc.location }}</li>
                {%- endfor -%}
            </ul>
            <h3>Sectors:</h3>
            <ul>
                {%- for sec in metadata.sectors -%}
                <li>{{ sec.sector }}</li>
                {%- endfor -%}
            </ul>
            <h3>Infrastructure Used</h3>
            <ul>
                {%- for inf in metadata.infrastructure_used -%} 
                <li>{{ inf.infrastructure }}</li>
                {%- endfor -%}
            </ul>
            <h3>Actor Motivation:</h3>
            <ul>
                {%- for motive in metadata.threat_actor_motivation -%}
                <li>{{ motive.threat_actor_motivation }}</li>
                {%- endfor -%}
            </ul>
    </body>
</html>
